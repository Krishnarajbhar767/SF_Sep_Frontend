import{a as P,u as F,d as b,r as h,e as I,j as s,m as A,I as l,aC as k,W as D,au as c,aD as R,h as U}from"./index-DRzNUvPi.js";import{S as g}from"./SelectField-CrNwXiMd.js";import{u as E}from"./uploadMedia-C7vyjgeF.js";import{p as H}from"./product.api-Bidbkf8n.js";const z=()=>{const{register:a,handleSubmit:f,formState:{errors:r},reset:x}=P(),v=F(),j=b(e=>e.category.categories||[]),d=b(e=>e.fabrics),[m,o]=h.useState([]),[p,n]=h.useState([]),y=I(),q=e=>{const i=Array.from(e.target.files);o(i);const t=i.map(u=>URL.createObjectURL(u));n(t)},w=e=>{const i=[...m],t=[...p];i.splice(e,1),t.splice(e,1),o(i),n(t)},N=async e=>{if(console.log(e),m.length===0){c.error("Please upload at least one image.");return}const i=c.loading("Please wait...");try{const t={type:"products",identifier:e.productId||e.name},u=await E(m,t);if(!u)return;e.images=u;const C=await H.createProduct(e);y(R(C)),x(),o([]),n([]),c.success("Product created successfully")}catch(t){U(t)}finally{c.dismiss(i)}},S=()=>{x(),o([]),n([]),v(-1)};return s.jsxs(A.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.3},className:"space-y-6 p-4 sm:p-6 max-w-2xl mx-auto",children:[s.jsx("h3",{className:"text-lg font-semibold uppercase text-gray-800 mb-4 tracking-wide",children:"Add Product"}),s.jsxs("form",{onSubmit:f(N),className:"space-y-4",children:[s.jsx(l,{label:"Name",name:"name",register:a,errors:r,rules:{required:"Product name is required"}}),s.jsx(l,{label:"Description",name:"description",register:a,errors:r,rules:{required:"Description is required"}}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[s.jsx(l,{label:"Price",name:"price",type:"number",register:a,errors:r,rules:{required:"Price is required",min:{value:0,message:"Must be positive"}}}),s.jsx(l,{label:"Stock",name:"stock",type:"number",register:a,errors:r,rules:{required:"Stock is required",min:{value:0,message:"Must be positive"}}})]}),s.jsx(g,{label:"Category",name:"category",register:a,errors:r,rules:{required:"Category is required"},options:j.map(e=>({value:e._id||e.value,label:e.name||e.label,disabled:e.name=="all"}))}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm text-gray-600 mb-1 flex items-center gap-2",children:[s.jsx(k,{size:16})," Images"]}),s.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:q,className:"w-full p-2 border border-gray-300 rounded-md text-sm text-gray-800"}),p.length>0&&s.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:p.map((e,i)=>s.jsxs("div",{className:"relative w-16 h-16",children:[s.jsx("img",{src:e,alt:`Preview ${i}`,className:"w-full h-full object-cover rounded-md"}),s.jsx("button",{type:"button",onClick:()=>w(i),className:"absolute top-0 right-0 bg-white rounded-full p-0.5 shadow-md",children:s.jsx(D,{size:12})})]},i))})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[s.jsx(g,{label:"Fabric",name:"fabric",register:a,errors:r,rules:{required:"Fabric is required"},options:d==null?void 0:d.map(e=>({value:e._id||e.value,label:e.title||e.label}))}),s.jsx(l,{label:"Technique",name:"technique",register:a,errors:r,rules:{required:"Technique is required"}})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[s.jsx(l,{label:"Color",name:"color",register:a,errors:r,rules:{required:"Color is required"}}),s.jsx(l,{label:"Weight (KG)",name:"weight",register:a,errors:r,rules:{required:"Weight is required"}})]}),s.jsx(l,{label:"Assurance",name:"assurance",register:a,errors:r,rules:{required:"Assurance is required"}}),s.jsx(l,{label:"HSN Code",name:"hsnCode",register:a,value:"5507",errors:r,rules:{required:"HSN Code is required",pattern:{value:/^[0-9]+$/,message:"HSN Code must contain only numbers"}}}),s.jsx(g,{label:"Offer",name:"isOfferAplied",register:a,errors:r,value:!1,options:[{name:"Yes",value:!0},{name:"No",value:!1}].map(e=>({value:e._id||e.value,label:e.name||e.label,disabled:e.name=="all"}))}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[s.jsx("button",{type:"submit",className:"bg-neutral-950 h-12 text-white px-4 py-2 text-sm uppercase hover:bg-gray-700 transition-colors duration-200 shadow-md w-full",children:"Save"}),s.jsx("button",{type:"button",onClick:S,className:"bg-gray-200 text-gray-800 px-4 py-2 text-sm uppercase hover:bg-gray-300 transition-colors duration-200 shadow-md w-full",children:"Cancel"})]})]})]})};export{z as default};
